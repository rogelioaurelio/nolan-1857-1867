<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Diagrama de Nolan hist√≥rico (1857‚Äì1867) ‚Äî CCH Naucalpan</title>
<style>
  :root{
    --ink:#0f172a; --muted:#64748b;
    --line:#cbd5e1; --grid:#eef2f7; --panel:#f8fafc;
    --pt:#1e88e5; --me:#e11d48;
  }
  body{font-family:system-ui,-apple-system,Segoe UI,Roboto,Ubuntu,Arial,Helvetica,sans-serif;
       color:var(--ink); background:#fff; margin:0 auto; max-width:1100px; padding:28px}
  h1{margin:0 0 10px}
  #presentacion{border:1px solid var(--line); border-left:6px solid #7a1f1f; border-radius:14px;
    padding:16px 20px; background:linear-gradient(180deg,#fff,#fafafa); margin:8px 0 20px}
  #graph{display:block; width:900px; height:900px; margin:12px auto; background:var(--panel);
    border:1px solid var(--line); border-radius:16px; box-shadow:0 8px 24px rgba(2,6,23,.05)}
  .legend{display:flex; gap:16px; align-items:center; margin:8px 0}
  .dot{width:12px;height:12px;border-radius:50%}
  .me{background:var(--me)} .hx{background:var(--pt)}
  .row{display:grid; grid-template-columns:1fr 1fr; gap:18px}
  @media (max-width:1000px){#graph{width:100%;height:auto;aspect-ratio:1/1}}
  .question{margin:8px 0}
  .likert label{margin-right:10px; color:var(--muted)}
  .btns{display:flex; flex-wrap:wrap; gap:10px; align-items:center; margin-top:10px}
  button{padding:10px 14px; border:1px solid var(--line); border-radius:12px; cursor:pointer}
  .primary{background:#111;color:#fff}
  .ghost{background:#fff;color:#111}
  .note{color:var(--muted)}
</style>
</head>
<body>
<h1>üß≠ Diagrama de Nolan hist√≥rico (1857‚Äì1867)</h1>

<section id="presentacion">
  <p>
    Este recurso interactivo apoya el curso de <strong>Historia de M√©xico II</strong> del
    <strong>Colegio de Ciencias y Humanidades, Plantel Naucalpan (CCH Naucalpan)</strong>,
    para comprender el <strong>pensamiento pol√≠tico en la Gran D√©cada Nacional (1857‚Äì1867)</strong>.
  </p>
  <p>
    El diagrama ubica posturas seg√∫n dos dimensiones:
    <br>ü°± <strong>Eje Y:</strong> libertades civiles y laicidad ‚Üï vs. autoridad y confesionalidad.
    <br>ü°≤ <strong>Eje X:</strong> libertad econ√≥mica y mercado ‚Üî vs. control estatal y privilegios corporativos.
  </p>
  <p>
    Tras el cuestionario, podr√°s comparar tu posici√≥n con la de <strong>personajes hist√≥ricos del siglo XIX</strong>
    (liberales y conservadores). Favorece el an√°lisis cr√≠tico de la <em>Constituci√≥n de 1857</em>,
    la <em>Reforma</em> y el <em>Segundo Imperio</em>.
  </p>
  <p style="text-align:right;color:#64748b"><em>Prof. Rogelio Aurelio Rojas Reyes</em></p>
</section>

<div class="legend">
  <span><i class="dot me"></i> Tu posici√≥n</span>
  <span><i class="dot hx"></i> Personajes hist√≥ricos</span>
</div>

<form id="quizForm">
  <div class="row">
    <section>
      <h3>Eje Y ‚Äì Libertades civiles y laicidad</h3>
      <div id="y-questions"></div>
    </section>
    <section>
      <h3>Eje X ‚Äì Econom√≠a y modelo de Estado</h3>
      <div id="x-questions"></div>
    </section>
  </div>
  <div class="btns">
    <button type="button" class="primary" onclick="calculate()">Ver resultado</button>
    <button type="button" class="ghost" onclick="resetForm()">Borrar respuestas</button>
    <button type="button" class="ghost" onclick="downloadPNG()">Descargar PNG</button>
    <span class="note">Marca del 1 (en desacuerdo) al 5 (de acuerdo).</span>
  </div>
</form>

<h3>Tu resultado</h3>
<p id="result" class="note">Contesta todo y presiona ‚ÄúVer resultado‚Äù.</p>

<canvas id="graph" width="900" height="900"></canvas>

<script>
/* ===================== PREGUNTAS ===================== */
const yItems = [
  "El Estado debe nacionalizar bienes de la Iglesia.",
  "Todos deben poder elegir libremente su religi√≥n.",
  "La prensa puede criticar al gobierno o a la Iglesia sin censura.",
  "El Estado, no la Iglesia, debe registrar nacimientos y matrimonios.",
  "Los cambios sociales deben ser r√°pidos, no graduales.",
  "La soberan√≠a nacional prevalece sobre alianzas ideol√≥gicas extranjeras.",
  "Igualdad ante la ley: sin fueros ni privilegios.",
  "Aunque la mayor√≠a sea cat√≥lica, la Iglesia no debe intervenir en lo p√∫blico.",
  "Es preferible una rep√∫blica democr√°tica a una monarqu√≠a ordenada.",
  "La Constituci√≥n debe respetarse, aunque pueda reformarse."
];
const xItems = [
  "Proteger la producci√≥n nacional con aranceles a importaciones.",
  "Impuestos progresivos a la riqueza.",
  "Impulsar la industria antes que el comercio exterior.",
  "Permitir el libre comercio para desarrollar la econom√≠a.",
  "No a un impuesto √∫nico universal igual para todos.",
  "Es v√°lido comprar bienes desamortizados de la Iglesia.",
  "El gobierno no debe ser excesivamente austero.",
  "Es mejor aliarse con EE. UU. que con Europa.",
  "Importa m√°s la funci√≥n social de la propiedad que su car√°cter individual.",
  "Es v√°lido repartir propiedades de quienes no cumplen obligaciones fiscales."
];
function makeBlock(list, id, pref){
  const c=document.getElementById(id);
  list.forEach((q,i)=>{
    const div=document.createElement('div');
    div.className='question';
    div.innerHTML=`<p>${i+1}. ${q}</p>
      <div class="likert">
        ${[1,2,3,4,5].map(v=>`<label><input type="radio" name="${pref}${i}" value="${v}" required> ${v}</label>`).join('')}
      </div>`;
    c.appendChild(div);
  });
}
makeBlock(yItems,'y-questions','y');
makeBlock(xItems,'x-questions','x');

/* ===================== DIBUJO ===================== */
const C=document.getElementById('graph'), ctx=C.getContext('2d');
const W=C.width, H=C.height, cx=W/2, cy=H/2;
const OUTER=90;                         // margen exterior (compacto)
const r=Math.min(W,H)/2 - OUTER;        // radio del rombo
const V={top:{x:cx,y:cy-r}, right:{x:cx+r,y:cy}, bottom:{x:cx,y:cy+r}, left:{x:cx-r,y:cy}};

function diamond(){ctx.beginPath();
  ctx.moveTo(V.top.x,V.top.y); ctx.lineTo(V.right.x,V.right.y);
  ctx.lineTo(V.bottom.x,V.bottom.y); ctx.lineTo(V.left.x,V.left.y); ctx.closePath();}

function project(x,y){ // normalizado -1..1 -> rombo
  const L1=Math.max(1,Math.abs(x)+Math.abs(y));
  return {px:cx+(x/L1)*r, py:cy-(y/L1)*r};
}
function roundRect(x,y,w,h,r){ctx.beginPath();
  ctx.moveTo(x+r,y);ctx.lineTo(x+w-r,y);ctx.quadraticCurveTo(x+w,y,x+w,y+r);
  ctx.lineTo(x+w,y+h-r);ctx.quadraticCurveTo(x+w,y+h,x+w-r,y+h);
  ctx.lineTo(x+r,y+h);ctx.quadraticCurveTo(x,y+h,x,y+h-r);
  ctx.lineTo(x,y+r);ctx.quadraticCurveTo(x,y,x+r,y);ctx.closePath();}

function base(){
  ctx.clearRect(0,0,W,H);
  // rejilla
  ctx.strokeStyle="#eef2f7";
  for(let t=0.2;t<1;t+=0.2){
    const s=1-t; ctx.beginPath();
    ctx.moveTo(cx,cy-r*s); ctx.lineTo(cx+r*s,cy); ctx.lineTo(cx,cy+r*s); ctx.lineTo(cx-r*s,cy);
    ctx.closePath(); ctx.stroke();
  }
  // rombo
  ctx.strokeStyle="#94a3b8"; ctx.lineWidth=2; diamond(); ctx.stroke();
  // ejes
  ctx.strokeStyle="#cbd5e1"; ctx.lineWidth=1.5;
  ctx.beginPath(); ctx.moveTo(V.left.x,V.left.y); ctx.lineTo(V.right.x,V.right.y); ctx.stroke();
  ctx.beginPath(); ctx.moveTo(V.top.x,V.top.y); ctx.lineTo(V.bottom.x,V.bottom.y); ctx.stroke();

  // categor√≠as de cuadrante (centradas)
  ctx.fillStyle="#374151"; ctx.font="600 16px system-ui"; ctx.textAlign="center";
  const q=r*0.30;
  ctx.fillText("Liberal moderado",        cx-q, cy-q);
  ctx.fillText("Liberal radical",         cx+q, cy-q);
  ctx.fillText("Conservador corporativo", cx-q, cy+q);
  ctx.fillText("Conservador ilustrado",   cx+q, cy+q);

  // r√≥tulos en v√©rtices (alineados a sus aristas). DIST peque√±o -> compacto
  vertexLabel(V.left,   3*Math.PI/4, "Laicidad y libertades civiles", 30);              // 1
  vertexLabel(V.bottom,-3*Math.PI/4, "Confesionalidad y autoritarismo", 30);            // 2
  vertexLabel(V.bottom, -Math.PI/4,  "Control estatal y privilegios corporativos", 30); // 3
  vertexLabel(V.right,  Math.PI/4,   "Libre mercado y anticorporativismo", 30);         // 4
}

// r√≥tulo paralelo a la arista que sale del v√©rtice
function vertexLabel(v, edgeAngle, text, dist){
  let ang=edgeAngle, nx=Math.cos(ang-Math.PI/2), ny=Math.sin(ang-Math.PI/2);
  const x=v.x+nx*dist, y=v.y+ny*dist;
  if(Math.abs(ang)>Math.PI/2) ang+=Math.PI; // mantener ‚Äúde pie‚Äù
  ctx.save(); ctx.translate(x,y); ctx.rotate(ang);
  ctx.font="bold 14px system-ui";
  const pad=6, w=ctx.measureText(text).width+pad*2, h=22;
  ctx.fillStyle="#fff"; ctx.strokeStyle="#e5e7eb"; roundRect(-w/2,-h/2,w,h,8); ctx.fill(); ctx.stroke();
  ctx.fillStyle="#111"; ctx.textAlign="center"; ctx.textBaseline="middle"; ctx.fillText(text,0,0);
  ctx.restore();
}

/* ===================== HIST√ìRICOS ===================== */
const historicos=[
  {name:"Benito Ju√°rez",x:+0.60,y:+0.70},
  {name:"Melchor Ocampo",x:+0.70,y:+0.60},
  {name:"Ponciano Arriaga",x:+0.65,y:+0.55},
  {name:"Ignacio Comonfort",x:-0.20,y:+0.45},
  {name:"S. Lerdo de Tejada",x:-0.10,y:+0.50},
  {name:"Maximiliano",x:+0.35,y:-0.30},
  {name:"Lucas Alam√°n",x:-0.65,y:-0.40},
  {name:"Arz. Labastida",x:-0.70,y:-0.60}
];

// posicionador compacto de nombres (elige la mejor de 8 posiciones cercanas)
const taken=[];
const overlap=(a,b)=>!(a.x+a.w<=b.x||b.x+b.w<=a.x||a.y+a.h<=b.y||b.y+b.h<=a.y);
function placeName(text, px, py){
  ctx.font="13px system-ui";
  const pad=6, w=ctx.measureText(text).width+pad*2+8, h=20;
  const opts=[
    {x:px+10,   y:py-h/2},   {x:px+10,   y:py-h-4},   {x:px+10,   y:py+4},
    {x:px-w-10,y:py-h/2},   {x:px-w-10,y:py-h-4},   {x:px-w-10,y:py+4},
    {x:px-w/2, y:py-h-8},   {x:px-w/2, y:py+8}
  ];
  let rect=null;
  for(const o of opts){
    const rct={x:o.x,y:o.y,w,h};
    if(!taken.some(t=>overlap(t,rct))){rect=rct;break;}
  }
  if(!rect){rect={x:px+10,y:py-h/2,w,h};}
  taken.push(rect);
  ctx.fillStyle="#fff"; ctx.strokeStyle="#e5e7eb"; roundRect(rect.x,rect.y,rect.w,rect.h,7); ctx.fill(); ctx.stroke();
  ctx.fillStyle="#0b3a70"; ctx.textAlign="left"; ctx.textBaseline="middle";
  ctx.fillText(text, rect.x+pad, rect.y+rect.h/2);
}
function drawPeople(){
  taken.length=0;
  historicos.forEach(h=>{
    const {px,py}=project(h.x,h.y);
    ctx.fillStyle="var(--pt)"; ctx.beginPath(); ctx.arc(px,py,5,0,Math.PI*2); ctx.fill();
    placeName(h.name, px, py);
  });
}

/* ===================== CUESTIONARIO ‚Üí PUNTO ===================== */
function resetForm(){
  document.getElementById('quizForm').reset();
  document.getElementById('result').innerText="Contesta todo y presiona ‚ÄúVer resultado‚Äù.";
  base(); drawPeople();
}
function calculate(){
  let ySum=0,xSum=0;
  for(let i=0;i<10;i++){
    const y=document.querySelector(`input[name='y${i}']:checked`);
    const x=document.querySelector(`input[name='x${i}']:checked`);
    if(!y||!x){alert("Faltan respuestas en alguna fila.");return;}
    ySum+=+y.value; xSum+=+x.value;
  }
  const yN=(ySum-15)/10, xN=(xSum-15)/10; // 5..25 ‚Üí -1..1
  document.getElementById('result').innerText=
    `Coordenadas: Y=${ySum.toFixed(1)} (‚Üí ${yN.toFixed(2)}),  X=${xSum.toFixed(1)} (‚Üí ${xN.toFixed(2)})`;
  base(); drawPeople();
  // dibuja tu punto
  const {px,py}=project(xN,yN);
  ctx.fillStyle="rgba(225,29,72,.18)"; ctx.beginPath(); ctx.arc(px,py,12,0,Math.PI*2); ctx.fill();
  ctx.fillStyle="var(--me)"; ctx.beginPath(); ctx.arc(px,py,6,0,Math.PI*2); ctx.fill();
  // etiqueta peque√±a
  ctx.font="12px system-ui"; const lab=`(${xN.toFixed(2)}, ${yN.toFixed(2)})`;
  ctx.fillStyle="#111"; ctx.textAlign="left"; ctx.fillText(lab, px+10, py-10);
}
function downloadPNG(){
  const a=document.createElement('a'); a.download='nolan-1857-1867.png';
  a.href=document.getElementById('graph').toDataURL('image/png'); a.click();
}

/* ===================== RENDER INICIAL ===================== */
base(); drawPeople();
</script>
</body>
</html>
